enable_testing()

find_package(GTest REQUIRED)
include_directories(include ${GTEST_INCLUDE_DIRS})

set(TARGET {{project_name}})
set(GTEST_TARGET ${TARGET}_test)
file(GLOB_RECURSE TESTS_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} *.cpp)

add_executable(${GTEST_TARGET} ${TESTS_FILES})
target_link_libraries(${GTEST_TARGET}
    ${TARGET}
    ${GTEST_BOTH_LIBRARIES}
    ${LIBRARIES}
)

add_test(GTest ${GTEST_TARGET})

if(CMAKE_COMPILER_IS_GNUC OR CMAKE_COMPILER_IS_GNUCXX)
    target_link_libraries(${GTEST_TARGET} pthread)
endif()

# vim:ft=cmake
